<div class="export-import-container">
  <div class="page-header">
    <h1>Export & Import Settings</h1>
    <p class="subtitle">
      @if (isLoggedIn) {
        Sync your GitLab Dashboard settings across multiple devices
      } @else {
        Import your settings to login or sync across devices
      }
    </p>
  </div>

  <div class="content-grid">
    <!-- Export Section -->
    @if (isLoggedIn) {
      <div class="section-card card">
        <div class="section-header">
          <h2>Export Settings</h2>
          <p class="section-description">
            Export your credentials and pinned repositories to use on another device
          </p>
        </div>

        <div class="export-content">
          <button class="btn btn-primary" (click)="exportUserData()">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 1V11M8 11L5 8M8 11L11 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M1 13V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>Generate Export</span>
          </button>

        @if (exportData) {
          <div class="export-result">
            <div class="export-actions">
              <button class="btn btn-secondary copy-button" (click)="copyToClipboard()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6 2H12C12.5523 2 13 2.44772 13 3V9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  <rect x="3" y="6" width="8" height="8" rx="1" stroke="currentColor" stroke-width="1.5"/>
                </svg>
                <span>Copy to Clipboard</span>
              </button>
              <button class="btn btn-secondary" (click)="downloadFile()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8 1V11M8 11L5 8M8 11L11 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M1 13V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>Download File</span>
              </button>
            </div>
            <textarea 
              class="export-textarea" 
              [value]="exportData" 
              readonly
              rows="10"
            ></textarea>
          </div>
        }
      </div>
    </div>
    }

    <!-- Import Section -->
    <div class="section-card card">
      <div class="section-header">
        <h2>Import Settings</h2>
        <p class="section-description">
          Import settings from another device by pasting JSON or uploading a file
        </p>
      </div>

      <div class="import-content">
        <div class="import-methods">
          <label class="file-upload-label">
            <input 
              type="file" 
              accept=".json,application/json" 
              class="file-input"
              (change)="onImportChange($event)"
            />
            <span class="file-upload-button btn btn-secondary">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 11V1M8 1L5 4M8 1L11 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M1 13V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              <span>Upload JSON File</span>
            </span>
          </label>
        </div>

        <div class="import-textarea-container">
          <label class="textarea-label">Or paste JSON data:</label>
          <textarea 
            class="import-textarea" 
            [(ngModel)]="importData"
            placeholder="Paste your export data here..."
            rows="10"
          ></textarea>
        </div>

        @if (importError) {
          <div class="error-message">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M8 5V8M8 11H8.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>{{ importError }}</span>
          </div>
        }

        @if (importSuccess) {
          <div class="success-message">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M5 8L7 10L11 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Settings imported successfully!</span>
          </div>
        }

        <div class="import-actions">
          <button 
            class="btn btn-primary" 
            (click)="importUserData()"
            [disabled]="!importData.trim()"
          >
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 11V1M8 1L5 4M8 1L11 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M1 13V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>Import Settings</span>
          </button>
          @if (importData) {
            <button class="btn btn-ghost" (click)="clearImport()">
              Clear
            </button>
          }
        </div>
      </div>
    </div>
  </div>

    <div class="info-card card">
      <h3>@if (isLoggedIn) { What gets exported? } @else { What can be imported? }</h3>
      <ul class="info-list">
        <li>GitLab username and personal access token</li>
        <li>Pinned repositories and their order</li>
      </ul>
      <p class="info-note">
        <strong>Note:</strong> Your credentials are stored in the export file. Keep it secure and don't share it with others.
        @if (!isLoggedIn) {
          <br><br>
          <strong>Login via Import:</strong> You can import a settings file to automatically login without entering credentials manually.
        }
      </p>
    </div>
</div>

